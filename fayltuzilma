app/
â”œâ”€ _layout.tsx                        # Root (expo-router) â€“ Reanimated/Gesture handler provider
â”œâ”€ index.tsx                          # Auth tekshiradi â†’ (auth)/login yoki (main)/home
â”œâ”€ (auth)/
â”‚  â””â”€ login.tsx                       # Lokal sign-in (bitta login/parol)
â”œâ”€ (main)/
â”‚  â”œâ”€ _layout.tsx                     # Header + chap menyu (Ğ¤Ğ¸Ğ»Ğ¸Ğ°Ğ»Ğ»Ğ°Ñ€/Ğ”ÑĞºĞ¾Ğ½Ğ»Ğ°Ñ€/ĞĞ´Ğ¼Ğ¸Ğ½)
â”‚  â”œâ”€ home.tsx                        # Default â€“ â€œĞ¼ĞµĞ½ÑĞ½Ğ¸ Ğ¾Ñ‡Ğ¸Ğ½Ğ³â€ ekrani
â”‚  â”œâ”€ admin/
â”‚  â”‚  â”œâ”€ add-store.tsx                # Ğ¤Ğ¸Ğ»Ğ¸Ğ°Ğ»/Ğ”ÑĞºĞ¾Ğ½ Ò›ÑÑˆĞ¸Ñˆ (radio, kategoriya narxlari, CRUD roâ€˜yxat)
â”‚  â”‚  â”œâ”€ catalog.tsx                  # ĞšĞ°Ñ‚Ğ°Ğ»Ğ¾Ğ³: nom + filial/doâ€˜kon narx, roâ€˜yxat, CRUD
â”‚  â”œâ”€ expenses/
â”‚  â”‚  â”œâ”€ _layout.tsx                
â”‚  â”‚  â”œâ”€ bank.tsx  
â”‚  â”‚  â”œâ”€ family.tsx  
â”‚  â”‚  â”œâ”€ index.tsx  
â”‚  â”‚  â”œâ”€ report.tsx  
â”‚  â”‚  â”œâ”€ shop.tsx  
â”‚  â””â”€ store/
â”‚     â””â”€ [id]/
â”‚        â”œâ”€ _layout.tsx               # Pastki fixed tablar: Ğ”Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´ / Ğ¡Ğ¾Ñ‚ÑƒĞ² / ÒšĞ°Ğ¹Ñ‚Ğ°Ñ€Ğ¸Ñˆ
â”‚        â”œâ”€ dashboard.tsx             # Koâ€˜rsatkichlar (storeId boâ€˜yicha)
â”‚        â”œâ”€ sales.tsx                 # Ğ¡Ğ¾Ñ‚ÑƒĞ²: forma + addSale
â”‚        â”œâ”€ history.tsx
â”‚        â””â”€ returns.tsx               # ÒšĞ°Ğ¹Ñ‚Ğ°Ñ€Ğ¸Ñˆ: forma + addReturn
components/
â”œâ”€ expenses/
â”‚  â”œâ”€ ExpenseComposer.tsx                     
â”‚  â”œâ”€ ExpenseRow.tsx   
â”‚  â”œâ”€ HistoryCard.tsx  
â”‚  â”œâ”€ ReportCards.tsx  
â”œâ”€ UI.tsx 
â”œâ”€ NetBanner.tsx 
â”œâ”€ Toast.tsx 
â”œâ”€ PdfModal.tsx 
lib/
â”œâ”€ supabase.ts                         # Supabase client (authsiz, realtime yoqilgan)
â”œâ”€ net.ts
â”œâ”€ pdf.ts
â”œâ”€ device.ts  
â”œâ”€ local-auth.ts                       # Lokal sign-in (AsyncStorageâ€™da flag)
â””â”€ storage.ts                          # AsyncStorage helperâ€™lar (getJSON/setJSON, kalitlar)
store/
â”œâ”€ inventoryStore.ts
â”œâ”€ syncStore.ts
â”œâ”€ expensesStore.ts
â”œâ”€ toastStore.ts
â””â”€ appStore.ts                         # Barcha state/CRUD/Queue + Push/Pull/Realtime (Zustand)
types/
â””â”€ index.ts                            # Tiplar: Store/Category/Product/Sale/Return/QueueItem va hok.
utils/
â”œâ”€ format.ts                           # (ixtiyoriy) formatMoney, date helpersâ€¦






; REJA !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

1ï¸âƒ£ Analiz va tayyorgarlik

 Hozirgi jadval strukturasini koâ€˜rib chiqamiz (sales, returns, cash_receipts, stores va h.k.).

 Hisobot uchun kerakli ustunlar roâ€˜yxatini tuzamiz (doâ€˜kon nomi, sana, summa, qarz formulasi).

 Maâ€™lumot hajmi boâ€˜yicha baho: 1 oyda taxminan nechta yozuv tushadi â†’ qaysi paytdan arxivlash kerakligini belgilaymiz (masalan, 3 oydan keyin).

ğŸ“Œ Natija: texnik talablarga mos jadval/ustunlar hujjati.

2ï¸âƒ£ Umumiy yigâ€˜ma (summary) jadvallarini yaratish

 monthly_store_summary jadvalini SQLâ€™da ochish.
(Doâ€˜kon/filial boâ€˜yicha oyma-oy sotuv, qaytarish, tushum, qarz.)

 recompute_monthly_summary(ym) funksiyasini yozish.
(Bir oy uchun umumiy natija qayta hisoblanadi.)

 Test: 1â€“2 oy uchun mavjud maâ€™lumotlardan hisobot chiqarish.

ğŸ“Œ Natija: tezkor umumiy hisobot chiqariladigan jadval.

3ï¸âƒ£ Arxivlash mexanizmi

 archive sxemasini yaratish (masalan: archive.sales).

 archive_month(ym) funksiyasini yozish.
(Eski yozuvlarni hot jadvallardan arxivga koâ€˜chiradi.)

 Test: eski oy maâ€™lumotlarini koâ€˜chirib koâ€˜rish â†’ hisobotda natija oâ€˜zgarmasligi kerak.

ğŸ“Œ Natija: Supabase toâ€˜lib qolmaydigan tizim.

4ï¸âƒ£ Qarz (Debt)ni xavfsiz yuritish

 ledger_entries jadvalini yaratish.
(Har bir sotuv, qaytarish, tushum yozuvini +/â€“ belgisi bilan kiritish.)

 Yangi yozuvlar kiritilganda ledger ham yangilanadigan trigger yozish.

 Test: 1 ta sotuv, 1 ta tushum qoâ€˜shib qarzni tekshirish.

ğŸ“Œ Natija: qarz har doim aniq va yoâ€˜qolmaydigan boâ€˜ladi.

5ï¸âƒ£ Dashboard integratsiyasi

 â€œUmumiy hisobotâ€ boâ€˜limini qoâ€˜shish.

Foydalanuvchi oyni tanlasa â†’ monthly_store_summarydan maâ€™lumot keladi.

Agar arxivdan koâ€˜rilsa â†’ archivedan yoki PDF yuklab olish imkoniyati.

 PDF yaratish tugmasi:

Jarayon: toast.show("Hisobot tayyorlanmoqdaâ€¦")

Tugagach: oâ€˜rtada popup â†’ â€œMana sizning PDF hisobot linkiâ€.

ğŸ“Œ Natija: mijoz oddiy tugma bosib oylik hisobotni koâ€˜radi yoki yuklab oladi.

6ï¸âƒ£ Avtomatlashtirish

 Supabase Edge Function yoki pg_cron yordamida:

Har kuni kechasi â†’ recompute_monthly_summary

Har oy boshida â†’ archive_month

 Test: avtomatlashtirilgan cron ishlayotganini loglarda tekshirish.

ğŸ“Œ Natija: tizim doimiy ravishda oâ€˜zi ishlaydi, qoâ€˜lda aralashish kerak emas.

7ï¸âƒ£ Hujjatlash va trening

 Admin panel foydalanuvchilari uchun qisqa qoâ€˜llanma yozish:

â€œUmumiy hisobotâ€ni qanday olish

PDF yuklab olish

Arxivdan maâ€™lumot olish

 Jamoa ichida 1 kunlik trening: yangi jarayonni tushuntirish.

ğŸ“Œ Natija: mijoz oâ€˜zi mustaqil ishlay oladi.